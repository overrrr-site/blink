# Blink - 犬の幼稚園向け顧客管理システム 要件定義書

## 1. プロジェクト概要

### 1.1 背景と目的

犬の幼稚園・保育園業界では、顧客管理や連絡帳のやり取りが紙媒体やLINEの手作業に依存しており、以下の課題が存在する。

**現状の課題**
- 飼い主からの情報を手入力で管理システムに転記（10頭で1時間以上）
- 紙媒体の連絡帳のコピー保管、LINEでのやり取りが煩雑
- 月々の回数契約でキャンセル対応が複雑になりがち
- 動物取扱業の5年間記録保管義務への対応が困難
- 既存の人向けサロンシステム（サロンドプロ等）では幼稚園特有の情報が入力できない
- 機能が多すぎて使いこなせない（販促機能など不要な機能が多い）

**本システムの目的**
- 犬の幼稚園に特化したシンプルで使いやすい顧客管理システムの提供
- 飼い主との情報連携による入力作業の大幅削減
- 生成AIを活用した日誌作成の効率化
- 将来的にはLINEミニアプリとしてのシームレスな体験提供

### 1.2 ターゲットユーザー

**主要ターゲット**: 個人経営の犬の幼稚園・保育園（まずは個人から普及）

**市場規模（参考）**
- 訓練業の施設数：全国で約2,500〜3,000軒前後
- トリミングサロンやペットショップチェーンが運営する幼稚園も増加傾向

### 1.3 システム構成

| 利用者 | プラットフォーム | 主な機能 | 実装状況 |
|--------|------------------|----------|:--------:|
| 飼い主 | LINEミニアプリ | 予約・キャンセル、登園前情報入力、QRチェックイン・チェックアウト、日誌閲覧、回数券残高確認 | ✅ 実装済み（設定要） |
| スタッフ | Webアプリ | 顧客・犬情報管理、予約管理、日誌作成、QRコード発行・印刷、記録保管 | ✅ 実装済み |

---

## 2. 機能要件

### 2.1 顧客・犬情報管理 ✅ 実装済み

#### 2.1.1 飼い主情報

| 項目 | 必須 | 備考 | 実装状況 |
|------|:----:|------|:--------:|
| 氏名 | ○ | | ✅ |
| フリガナ | ○ | | ✅ |
| 電話番号 | ○ | | ✅ |
| メールアドレス | - | LINE連携のため任意 | ✅ |
| 住所 | ○ | 都道府県・市区町村・番地・建物名 | ✅ |
| 緊急連絡先 | ○ | 飼い主以外の連絡先 | ✅ |
| 緊急時引取り者 | ○ | 飼い主以外で引取り可能な方 | ✅ |
| LINE ID | - | LINEミニアプリ連携 | ✅ |
| 登録日 | ○ | 自動記録 | ✅ |
| 最終予約日 | ○ | 自動記録・一覧表示 | ✅ |
| メモ | - | 自由記述 | ✅ |

#### 2.1.2 犬情報（基本情報）

| 項目 | 必須 | 備考 | 実装状況 |
|------|:----:|------|:--------:|
| 名前 | ○ | | ✅ |
| 犬種 | ○ | マスタから選択＋自由入力 | ✅ |
| 生年月日 | ○ | 年齢自動計算 | ✅ |
| 性別 | ○ | オス/メス | ✅ |
| 体重 | ○ | 定期更新を推奨 | ✅ |
| 毛色 | ○ | | ✅ |
| マイクロチップ番号 | - | | ✅ |
| 写真 | ○ | プロフィール写真 | ✅ |
| 去勢・避妊 | ○ | 済/未 | ✅ |

#### 2.1.3 犬情報（健康・ワクチン）

| 項目 | 必須 | 備考 | 実装状況 |
|------|:----:|------|:--------:|
| 混合ワクチン接種日 | ○ | 1年以内必須、期限アラート機能 | ✅ |
| 狂犬病予防接種日 | ○ | 1年以内必須、期限アラート機能 | ✅ |
| ワクチン証明書 | - | 画像アップロード | ✅ |
| 既往歴・持病 | - | | ✅ |
| アレルギー | - | 食物・環境 | ✅ |
| 服用中の薬 | - | | ✅ |
| かかりつけ動物病院 | - | 名称・電話番号 | ✅ |
| フード情報 | - | 銘柄、量、回数 | ✅ |

#### 2.1.4 犬情報（性格・特性）

| 項目 | 必須 | 備考 | 実装状況 |
|------|:----:|------|:--------:|
| 性格（自由記述） | - | | ✅ |
| 他の犬との相性 | ○ | 良好/普通/苦手/要注意 | ✅ |
| 人への反応 | ○ | フレンドリー/普通/怖がり/要注意 | ✅ |
| 苦手なこと | - | 例：大きな音、特定の犬種 | ✅ |
| 好きなこと・おもちゃ | - | | ✅ |
| 噛み癖 | ○ | なし/軽度/あり（詳細記入） | ✅ |
| 吠え癖 | ○ | なし/軽度/あり（詳細記入） | ✅ |
| トイレの状況 | ○ | 完璧/ほぼOK/トレーニング中 | ✅ |
| クレート慣れ | ○ | 慣れている/練習中/苦手 | ✅ |

#### 2.1.5 多頭飼い対応 ✅ 実装済み

- 1飼い主に対して複数の犬を紐づけ可能
- 兄弟犬の関係性を記録可能
- 多頭割引の自動適用（2頭目5%OFF、3頭目10%OFF等、設定画面でカスタマイズ可能）

---

### 2.2 予約管理 ✅ 実装済み

#### 2.2.1 契約・コース管理

**一般的な契約パターン（調査結果）**

| 契約タイプ | 説明 | 例 | 実装状況 |
|------------|------|-----|:--------:|
| 月謝制（曜日固定） | 週N回×月4〜5週 | 週2回コース（月8〜10回） | ✅ |
| チケット制（回数券） | N回分を購入、有効期限あり | 10回券（有効期限3ヶ月） | ✅ |
| 単発利用 | 都度予約・支払い | 1回〜 | ✅ |
| パピー特別コース | 6ヶ月未満限定の割引コース | 週3回×6クール | ✅ |

**システムで管理する項目**

| 項目 | 説明 | 実装状況 |
|------|------|:--------:|
| コース名 | 例：週2回コース、10回チケット | ✅ |
| 契約タイプ | 月謝制/チケット制/単発 | ✅ |
| 回数 | 月あたり回数 or 総回数 | ✅ |
| 有効期限 | チケットの場合は購入から3ヶ月等 | ✅ |
| 料金 | 税込金額 | ✅ |
| 残回数 | 自動計算・表示 | ✅ |
| 消化履歴 | いつ何回使用したか | ✅ |

#### 2.2.2 予約機能

**飼い主側（LINEミニアプリ）** ✅ 実装済み（LIFF設定要）
- カレンダーから空き状況確認
- 予約申請（即時確定 or 承認制を選択可能）
- 予約変更・キャンセル
- 残回数・有効期限の確認

**スタッフ側（Webアプリ）** ✅ 実装済み
- カレンダー形式の予約一覧
- ドラッグ&ドロップでの予約変更
- 1日あたりの受入可能頭数設定（設定画面で変更可能）
- ダブルブッキング防止
- 予約確定・キャンセル処理
- ステップ形式の予約登録フォーム

#### 2.2.3 QRコードによる登園・降園管理 ✅ 実装済み

**概要**
- 店舗ごとに固定のQRコードを発行（設定画面から印刷可能）
- 飼い主はLINEミニアプリからQRコードをスキャンしてチェックイン・チェックアウト

**チェックイン（登園）**
| 項目 | 説明 |
|------|------|
| タイミング | 予約当日にLINEアプリで「登園する」ボタンをタップ |
| 処理内容 | 店舗のQRコードをスキャン → 予約ステータスを「チェックイン済」に更新 |
| 回数消化 | チケット制の場合、チェックイン時に残回数を自動消化 |

**チェックアウト（降園）**
| 項目 | 説明 |
|------|------|
| タイミング | チェックイン済みの状態で「降園する」ボタンをタップ |
| 処理内容 | 店舗のQRコードをスキャン → チェックアウト時刻を記録 |
| 表示 | チェックアウト完了後は「本日の登園完了」と表示 |

**QRコードの管理（スタッフ側）**
- 設定画面 > 店舗設定タブでQRコードを表示・印刷
- QRコードは店舗ごとに固定（変更なし）
- 印刷して店舗入口に掲示することを推奨

**フォールバック対応**
- QRスキャンが利用できない場合、手動入力フォームを表示
- スタッフからQRコードの内容を伝えてもらい、手動入力で対応可能

---

#### 2.2.4 キャンセル・振替ルール ✅ 実装済み

**キャンセルポリシー（設定画面でカスタマイズ可能）**

| タイミング | デフォルトキャンセル料 |
|------------|--------------|
| 3日前〜前日 | 30% |
| 当日 | 50% |
| 無断キャンセル | 100% |

**振替チケット（月謝制の場合）** ✅ 実装済み
- 体調不良等で登園できない場合に振替チケットを発行
- 有効期限：3ヶ月（設定可能）
- 振替チケットの一覧管理・使用状況確認

**システム機能**
- キャンセルポリシーを店舗ごとに設定可能
- 振替チケットの発行・管理
- 設定画面「料金・契約」タブで一括管理

---

### 2.3 連絡帳機能

#### 2.3.1 飼い主→店舗（登園前入力） ✅ 実装済み（LIFF設定要）

| カテゴリ | 項目 | 入力形式 |
|----------|------|----------|
| 排泄 | 午前のオシッコ/ウンチ | チェック |
| 排泄 | 午後のオシッコ/ウンチ | チェック |
| 食事 | 朝ごはんの食べ具合 | 選択（完食/少し残した/半分以下/食べていない） |
| 体調 | 体調の変化 | テキスト入力 |
| その他 | 連絡事項 | テキスト入力 |
| その他 | 次回登園日確認 | 日付表示 |

#### 2.3.2 店舗→飼い主（日誌） ✅ 実装済み

| カテゴリ | 項目 | 入力形式 | 実装状況 |
|----------|------|----------|:--------:|
| 基本情報 | 日付、担当スタッフ、登園回数 | 自動入力 | ✅ |
| トイレ | 午前：オシッコ/ウンチ | チェック＋場所 | ✅ |
| トイレ | 午後：オシッコ/ウンチ | チェック＋場所 | ✅ |
| トレーニング | トイレトレーニング項目 | チェックリスト＋達成度 | ✅ |
| トレーニング | 基本トレーニング項目 | チェックリスト＋達成度 | ✅ |
| コメント | 今日の様子 | テキスト入力（AI生成支援あり） | ✅ |
| 写真 | 活動写真 | 複数枚アップロード | ✅ |
| 次回 | 次回登園日 | 日付 | ✅ |

**トレーニング項目マスタ（設定画面でカスタマイズ可能）** ✅ 実装済み

カテゴリ表示順序（固定）: 基本 → トイレ → 社会化 → 問題行動

```
【基本トレーニング】
□ アイコンタクト
□ Down（ふせ）
□ Stay（まて）
□ Come（おいで）
□ Heel（横について）
□ オスワリ
□ マテ
□ フセ
□ オイデ

【トイレトレーニング】
□ 声かけでプログラム
□ リラックスポジション
□ ハウストレーニング
□ ディスク
□ ボールキャッチ/レット

【社会化トレーニング】
□ 他犬との交流
□ 人慣れ
□ 環境慣れ（音、物）
□ ハンドリング（体を触る）
□ 歯磨き練習

【問題行動対策】
□ 吠え対策
□ 噛み対策
□ 引っ張り対策
□ 飛びつき対策
```

**トレーニング項目の管理機能**
- カテゴリ内での並び替え（上下ボタン）
- 項目の編集・削除
- 「日誌で使用する」フラグで表示/非表示を制御

**達成度の表現**
- ○ できた
- △ もう少し
- ー 未実施

#### 2.3.3 AI活用による入力効率化 ✅ 実装済み

**1. チェック→文章自動生成** ✅ 実装済み（Google Gemini API）

スタッフがチェックした項目から、AIが自然な日本語の日誌コメントを生成。

```
【入力（チェック）】
✓ トイレ：午前・午後ともに成功
✓ 基本トレーニング：オスワリ○、マテ△
✓ 社会化：他犬との交流○
✓ 写真：3枚

【AI生成文（例）】
今日は歯磨きシートを使って歯を触っています♪
落ち着いていられるよう練習しました。
オスワリはバッチリできました！マテはもう少し練習が必要ですが、
お友達のワンちゃんたちとも仲良く遊べていました。
```

**2. 写真からの活動推測** ✅ 実装済み（Google Gemini Vision）

撮影した写真をAIが解析し、活動内容のサジェストを提供。

```
【写真】犬が3匹並んで座っている写真
【AIサジェスト】
「お友達と一緒にオスワリの練習をしました」
「集合写真を撮りました」
→ スタッフが選択・編集して採用
→ トレーニング項目の自動チェック提案
```

---

### 2.4 記録保管機能 ✅ 実装済み

#### 2.4.1 法的要件

**動物取扱業の記録保管義務**
- 保管期間：5年間
- 対象：顧客情報、犬情報、利用履歴、日誌等
- 形式：デジタル保管のみでも可

#### 2.4.2 システム要件

| 機能 | 説明 | 実装状況 |
|------|------|:--------:|
| 自動バックアップ | Supabaseによる自動バックアップ | ✅ |
| データエクスポート | CSV/PDF形式での一括出力 | ✅ |
| 検索機能 | 日付、犬名、飼い主名での検索 | ✅ |
| 閲覧ログ | いつ誰がどのデータを閲覧したか記録 | ✅ |
| 削除制限 | 5年以内のデータは削除不可（論理削除のみ） | ✅ |

---

### 2.5 回数券・契約管理 ✅ 実装済み

#### 2.5.1 決済方針

**店舗-飼い主間の決済**
- 月謝・回数券の支払いは店頭のPOSレジで対応
- 本システムでは決済機能を持たず、残数・契約の管理のみ行う
- 回数券の残数、有効期限の管理と表示

**SaaS利用料の決済** ✅ 実装済み（PAY.JP設定要）
- 幼稚園がこのサービスを利用するための月額料金
- PAY.JP決済で対応（管理画面から支払い）

#### 2.5.2 契約・回数券管理

| 機能 | 説明 | 実装状況 |
|------|------|:--------:|
| 回数券残数管理 | 購入時に残数を手動入力、利用時に自動消化 | ✅ |
| 有効期限管理 | 期限切れ間近のアラート表示 | ✅ |
| 契約情報管理 | 月謝制/チケット制/単発の契約タイプ管理 | ✅ |
| 消化履歴 | いつ何回使用したかの記録 | ✅ |
| 振替チケット管理 | 発行・使用・期限管理 | ✅ |

---

### 2.6 外部連携 ✅ 実装済み

#### 2.6.1 Googleカレンダー連携

| 機能 | 説明 | 実装状況 |
|------|------|:--------:|
| OAuth認証 | Googleアカウントでの認証 | ✅ |
| 予約→カレンダー同期 | 予約作成時に自動でGoogleカレンダーに登録 | ✅ |
| 予約変更同期 | 予約変更時にカレンダーイベントも更新 | ✅ |
| 予約削除同期 | 予約削除時にカレンダーイベントも削除 | ✅ |

---

## 3. 非機能要件

### 3.1 パフォーマンス

| 項目 | 要件 |
|------|------|
| 画面表示速度 | 3秒以内 |
| 同時接続数 | 100ユーザー以上 |
| データ保存期間 | 最低5年間 |

### 3.2 セキュリティ

| 項目 | 要件 | 実装状況 |
|------|------|:--------:|
| 通信 | HTTPS必須 | ✅ |
| 認証 | JWT認証（スタッフ） | ✅ |
| 認証 | LINE認証連携（飼い主） | ✅ |
| 個人情報保護 | 暗号化保存 | ✅ |
| アクセス制御 | 店舗ごとのデータ分離 | ✅ |

### 3.3 可用性

| 項目 | 要件 |
|------|------|
| 稼働率 | 99.5%以上 |
| バックアップ | 日次自動バックアップ（Supabase） |
| 障害復旧 | 24時間以内 |

---

## 4. 画面構成

### 4.1 飼い主向け（LINEミニアプリ） ✅ 実装済み（LIFF設定要）

| 画面 | 説明 | 作成状況 |
|------|------|:--------:|
| ホーム | 次回予約情報、登園/降園QRスキャン、メニュー | ✅ React実装 |
| マイページ | 飼い主情報・契約・回数券残数（自動計算） | ✅ React実装 |
| 予約カレンダー | 空き状況確認・予約申請 | ✅ React実装 |
| 登園前入力 | 当日の体調・食事等を入力 | ✅ React実装 |
| 日誌一覧・詳細 | 店舗からの日誌・写真確認 | ✅ React実装 |

**UI/UX仕様**
- ヘッダー: 店舗名を表示（左寄せ）
- 契約情報: チケット制の残回数は予約消化から自動計算
- 料金表示: 整数表示（小数点以下なし）
- トイレ項目アイコン: チェックマーク（完了）/ マイナス（未実施）

### 4.2 スタッフ向け（Webアプリ） ✅ 実装済み

| 画面 | 説明 | 作成状況 |
|------|------|:--------:|
| ログイン | スタッフログイン画面 | ✅ |
| ダッシュボード | 今日の予約・未入力日誌・アラート | ✅ |
| 飼い主一覧 | 飼い主の検索・一覧表示（最終予約日表示） | ✅ |
| 飼い主詳細 | 飼い主情報の詳細・編集 | ✅ |
| 飼い主登録/編集 | 新規登録・編集フォーム | ✅ |
| 犬一覧 | 犬の検索・一覧表示 | ✅ |
| 犬詳細 | 犬情報・契約・利用履歴・日誌履歴 | ✅ |
| 犬登録/編集 | 新規登録・編集フォーム | ✅ |
| 予約カレンダー | カレンダー形式の予約管理（ドラッグ&ドロップ対応） | ✅ |
| 予約登録 | ステップ形式の新規予約登録 | ✅ |
| 予約詳細 | 予約詳細・編集・キャンセル | ✅ |
| 日誌作成 | AI支援付き日誌作成（写真解析対応） | ✅ |
| 日誌履歴 | 過去の日誌一覧（PDF出力対応） | ✅ |
| 日誌詳細 | 日誌詳細・編集 | ✅ |
| 設定 | タブ形式の設定画面 | ✅ |

### 4.3 設定画面の構成 ✅ 実装済み

設定画面は4つのタブに整理されています：

**店舗設定タブ**
- 基本情報（店舗名、住所、営業時間）
- 営業日・定休日
- 受入可能頭数（1日あたりの上限）
- スタッフ管理（CRUD）
- トレーニング項目（カスタマイズ可能、並び替え対応）
- 登園用QRコード（表示・印刷機能）

**料金・契約タブ**
- コース・料金設定（月謝制/チケット制/単発）
- 振替チケット管理（一覧・発行・使用状況）
- 多頭割引設定（2頭目/3頭目/4頭目以降の割引率）
- キャンセルポリシー（タイミングごとのキャンセル料率）

**連携タブ**
- Googleカレンダー連携（OAuth認証・同期設定）
- LINE通知設定（有効/無効切り替え、テストメッセージ送信機能）
- 通知設定（リマインド・日誌送信・ワクチンアラート）

**その他タブ**
- データエクスポート（飼い主/犬/日誌データのCSV/PDF出力）
- プラン・お支払い
- ヘルプ・サポート
- 利用規約・プライバシーポリシー
- ログアウト

---

## 5. 技術構成

### 5.1 フロントエンド ✅ 実装済み

| 対象 | 技術 |
|------|------|
| スタッフ向け | React 18 + TypeScript + Vite |
| UIフレームワーク | Tailwind CSS |
| 状態管理 | Zustand |
| アイコン | Iconify |
| 日付処理 | date-fns |
| PDF出力 | jsPDF |

### 5.2 バックエンド ✅ 実装済み

| 項目 | 技術 |
|------|------|
| ランタイム | Node.js |
| フレームワーク | Express + TypeScript |
| データベース | PostgreSQL (Supabase) |
| 認証 | JWT (jsonwebtoken) |
| バリデーション | Zod |
| ファイルアップロード | Multer |
| AI機能 | Google Gemini API (gemini-1.5-flash) |
| カレンダー連携 | Google Calendar API |

### 5.3 インフラ

| 項目 | 技術 | 状況 |
|------|------|:----:|
| ホスティング | Vercel | ✅ |
| データベース | Supabase (PostgreSQL) | ✅ |
| ファイルストレージ | Supabase Storage | ✅ |
| 決済 | PAY.JP | ✅ |

---

## 6. 料金設計（案）

### 6.1 プラン構成

| プラン | 月額（税込） | 対象 | 主な制限 |
|--------|--------------|------|----------|
| フリー | ¥0 | 小規模（犬20頭以下） | 基本機能のみ、AI機能制限 |
| スタンダード | ¥5,500 | 中規模（犬100頭以下） | 全機能利用可 |
| プロ | ¥11,000 | 大規模・多店舗 | 無制限、優先サポート |

### 6.2 競合比較

| サービス | 月額 | 備考 |
|----------|------|------|
| CHERIEE | ¥3,190〜 | ペット業界特化、カルテ数制限あり |
| サロンドプロ等 | 〜¥10,000 | 人向けサロン、幼稚園非対応 |
| Blink | ¥5,500〜 | 幼稚園特化、AI機能搭載 |

---

## 7. 開発ロードマップ

### Phase 1: MVP ✅ 完了

- ✅ 顧客・犬情報管理
- ✅ 予約管理（カレンダー、ドラッグ&ドロップ）
- ✅ 日誌作成（チェックリスト形式、AI文章生成）
- ✅ スタッフ向けWebアプリ基本機能

### Phase 2: コア機能拡充 ✅ 完了

- ✅ 回数券・コース管理
- ✅ 契約・振替チケット管理
- ✅ AI文章生成（Google Gemini API）
- ✅ AI写真解析（Google Gemini Vision）
- ✅ Googleカレンダー連携
- ✅ 多頭割引・キャンセルポリシー設定
- ✅ スタッフ・コース・トレーニング項目マスタ管理
- ✅ データエクスポート（CSV/PDF）

### Phase 3: 飼い主向けアプリ ✅ 完了（設定要）

- ✅ LINEミニアプリ開発（LIFF）
- ✅ 飼い主による予約・キャンセル
- ✅ 登園前入力
- ✅ 日誌閲覧
- ✅ 残回数確認

**本番環境での有効化に必要な設定:**
- LINE DevelopersでLIFFアプリを作成し、`VITE_LIFF_ID`を設定
- 店舗ごとにLINE Messaging API認証情報をデータベースに設定
- 詳細は `ENV_SETUP.md` を参照

---

## 8. 成功指標（KPI）

| 指標 | 目標値 |
|------|--------|
| 導入店舗数（1年目） | 50店舗 |
| 月間アクティブユーザー | 導入店舗×平均30飼い主 |
| 日誌作成時間削減率 | 50%以上 |
| 継続利用率 | 90%以上 |
| NPS（顧客推奨度） | 40以上 |

---

## 付録A: 連絡帳サンプル（PLAYBOWフォーマット参照）

### 飼い主→店舗（登園前）

```
【飼い主さんから一言】
_______________________________
_______________________________

【次回登園日は ○月○日（○）です！】
```

### 店舗→飼い主（日誌）

```
○月○日  今日の _______ ちゃん/くん  担当 _______

〈午前：オシッコ/ウンチ〉
散歩中 / 自ら指定の場所でできた / 誘導して指定の場所でできた / できない

〈午後：オシッコ/ウンチ〉
散歩中 / 自ら指定の場所でできた / 誘導して指定の場所でできた / できない

♪お勉強内容                    できた☆  もう少し★
□ みんなでフセマテ              ○ ○ ○   ○ ○ ○
□ スピン                       ○ ○ ○   ○ ○ ○
□ 歯磨き慣れ                   ○ ○ ○   ○ ○ ○

[今日のコメント]
____________________________________________
____________________________________________

[写真]
（活動写真を貼付）

【次回登園日は ○月○日（○）です！】
```

---

## 付録B: トレーニング項目一覧

### 基本コマンド

| 項目 | 説明 |
|------|------|
| アイコンタクト | 名前を呼んだら飼い主を見る |
| オスワリ | 座る姿勢 |
| フセ | 伏せの姿勢 |
| マテ | その場で待機 |
| オイデ | 呼んだら来る |
| ヒール | 横について歩く |

### 社会化トレーニング

| 項目 | 説明 |
|------|------|
| 人慣れ | 様々な人（子供、高齢者、制服の人等）への慣れ |
| 犬慣れ | 他の犬との適切な交流 |
| 環境慣れ | 生活音、乗り物、様々な場所への慣れ |
| ハンドリング | 体を触られること、抱っこへの慣れ |

### 生活スキル

| 項目 | 説明 |
|------|------|
| トイレトレーニング | 指定場所での排泄 |
| クレートトレーニング | ハウスで落ち着いて過ごす |
| 歯磨き練習 | 口を触られること、歯磨きへの慣れ |
| リードワーク | 引っ張らずに歩く |

### 問題行動対策

| 項目 | 説明 |
|------|------|
| 無駄吠え対策 | 不必要な吠えの抑制 |
| 噛み癖対策 | 甘噛み、本気噛みの抑制 |
| 飛びつき対策 | 人への飛びつき抑制 |
| 分離不安対策 | 一人でいることへの慣れ |

---

## 付録C: API エンドポイント一覧

### 認証

| メソッド | パス | 説明 |
|----------|------|------|
| POST | /api/auth/login | ログイン |
| POST | /api/auth/register | 新規登録 |

### 飼い主管理

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/owners | 飼い主一覧取得 |
| GET | /api/owners/:id | 飼い主詳細取得 |
| POST | /api/owners | 飼い主登録 |
| PUT | /api/owners/:id | 飼い主更新 |
| DELETE | /api/owners/:id | 飼い主削除 |

### 犬管理

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/dogs | 犬一覧取得 |
| GET | /api/dogs/:id | 犬詳細取得（利用履歴・日誌履歴含む） |
| POST | /api/dogs | 犬登録 |
| PUT | /api/dogs/:id | 犬更新 |
| DELETE | /api/dogs/:id | 犬削除 |

### 予約管理

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/reservations | 予約一覧取得 |
| GET | /api/reservations/:id | 予約詳細取得 |
| POST | /api/reservations | 予約登録（多頭割引自動適用） |
| PUT | /api/reservations/:id | 予約更新 |
| DELETE | /api/reservations/:id | 予約削除 |

### 日誌管理

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/journals | 日誌一覧取得 |
| GET | /api/journals/:id | 日誌詳細取得 |
| POST | /api/journals | 日誌登録 |
| PUT | /api/journals/:id | 日誌更新 |
| DELETE | /api/journals/:id | 日誌削除 |

### 契約・振替チケット

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/contracts | 契約一覧取得 |
| POST | /api/contracts | 契約登録 |
| PUT | /api/contracts/:id | 契約更新 |
| DELETE | /api/contracts/:id | 契約削除 |
| GET | /api/makeup-tickets | 振替チケット一覧取得 |
| POST | /api/makeup-tickets | 振替チケット発行 |
| POST | /api/makeup-tickets/:id/use | 振替チケット使用 |
| DELETE | /api/makeup-tickets/:id | 振替チケット削除 |

### AI機能

| メソッド | パス | 説明 |
|----------|------|------|
| POST | /api/ai/generate-comment | 日誌コメント自動生成 |
| POST | /api/ai/analyze-photo | 写真からの活動推測 |

### 設定

| メソッド | パス | 説明 |
|----------|------|------|
| GET/PUT | /api/store-settings | 店舗設定（受入可能頭数） |
| GET/PUT | /api/multi-dog-discount | 多頭割引設定 |
| GET/PUT | /api/cancel-policies | キャンセルポリシー |
| GET/POST/PUT/DELETE | /api/staff | スタッフ管理 |
| GET/POST/PUT/DELETE | /api/course-masters | コースマスタ管理 |
| GET/POST/PUT/DELETE | /api/training-masters | トレーニング項目管理 |

### LIFF（飼い主向け）

| メソッド | パス | 説明 |
|----------|------|------|
| POST | /api/liff/auth | LINE認証・トークン発行 |
| GET | /api/liff/me | 飼い主情報・犬・契約・次回予約取得 |
| POST | /api/liff/link/send | LINEアカウント紐付け用確認コード送信 |
| POST | /api/liff/link/verify | 確認コード検証・紐付け完了 |
| GET | /api/liff/reservations | 予約一覧取得 |
| POST | /api/liff/reservations | 予約登録 |
| DELETE | /api/liff/reservations/:id | 予約キャンセル |
| POST | /api/liff/check-in | QRコードによるチェックイン（登園） |
| POST | /api/liff/check-out | QRコードによるチェックアウト（降園） |
| GET | /api/liff/qr-code | 店舗QRコード取得（スタッフ認証要） |
| GET | /api/liff/journals | 日誌一覧取得 |
| GET | /api/liff/journals/:id | 日誌詳細取得 |

### Googleカレンダー連携

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/google-calendar/status | 連携状況確認 |
| GET | /api/google-calendar/auth | OAuth認証開始 |
| GET | /api/google-calendar/callback | OAuth認証コールバック |
| POST | /api/google-calendar/disconnect | 連携解除 |

### 通知

| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/notifications/line-status | LINE連携状況確認 |
| POST | /api/notifications/test-line | LINEテストメッセージ送信 |

---

## 付録D: 更新履歴

| 日付 | 主な変更内容 |
|------|-------------|
| 2026-01-26 | QRコードによる登園・降園機能を追加 |
| 2026-01-26 | LINE通知設定・テストメッセージ機能を追加 |
| 2026-01-26 | トレーニング項目の並び替え・編集機能を追加 |
| 2026-01-26 | LIFFアプリのUI改善（ヘッダー店舗名表示、アイコン改善、料金表示整数化） |
| 2026-01-26 | 契約情報の残回数自動計算機能を追加 |
| 2026-01-26 | LIFF用APIエンドポイント一覧を追加 |

---

*本ドキュメントは2026年1月26日時点の実装状況を反映しています。*
